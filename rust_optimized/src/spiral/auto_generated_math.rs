use crate::spiral::optimization::SpiralParameters;

pub fn compute_cf_gradient(
    p: &SpiralParameters,
    alpha: f64,
    beta: f64,
    gamma: f64,
    x_0: f64,
    y_0: f64,
    psi_0: f64,
    x_f: f64,
    y_f: f64,
    psi_f: f64,
) -> [f64; 3] {
    let dc_dp_1 = (1_f64 / 12.0)
        * alpha
        * p[4]
        * ((1_f64 / 24.0)
            * p[4]
            * (psi_0.cos()
                + 4.0
                    * (0.125 * p[0] * p[4]
                        + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 6.103515625e-5
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.000651041666666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 2.0
                    * (0.25 * p[0] * p[4]
                        + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0009765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.00520833333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 4.0
                    * (0.375 * p[0] * p[4]
                        + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.00494384765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.017578125
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 2.0
                    * (0.5 * p[0] * p[4]
                        + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0416666666666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 4.0
                    * (0.625 * p[0] * p[4]
                        + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.03814697265625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0813802083333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 2.0
                    * (0.75 * p[0] * p[4]
                        + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0791015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.140625
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 4.0
                    * (0.875 * p[0] * p[4]
                        + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.14654541015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.223307291666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + (p[0] * p[4]
                    + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.333333333333333
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos())
            + x_0
            - x_f)
        * (-0.2259521484375
            * p[4]
            * (0.125 * p[0] * p[4]
                + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                + 6.103515625e-5 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                + 0.000651041666666667
                    * p[4]
                    * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                + psi_0)
                .sin()
            - 0.3544921875
                * p[4]
                * (0.25 * p[0] * p[4]
                    + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.0009765625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.00520833333333333
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
            - 1.2161865234375
                * p[4]
                * (0.375 * p[0] * p[4]
                    + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.00494384765625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.017578125 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
            - 0.796875
                * p[4]
                * (0.5 * p[0] * p[4]
                    + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.015625 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.0416666666666667
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
            - 1.7669677734375
                * p[4]
                * (0.625 * p[0] * p[4]
                    + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.03814697265625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.0813802083333333
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
            - 0.8701171875
                * p[4]
                * (0.75 * p[0] * p[4]
                    + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.0791015625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.140625 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
            - 1.5970458984375
                * p[4]
                * (0.875 * p[0] * p[4]
                    + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.14654541015625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.223307291666667
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
            - 0.375
                * p[4]
                * (p[0] * p[4]
                    + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.333333333333333
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin())
        + (1_f64 / 12.0)
            * beta
            * p[4]
            * ((1_f64 / 24.0)
                * p[4]
                * (psi_0.sin()
                    + 4.0
                        * (0.125 * p[0] * p[4]
                            + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 6.103515625e-5
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.000651041666666667
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 2.0
                        * (0.25 * p[0] * p[4]
                            + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.0009765625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.00520833333333333
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 4.0
                        * (0.375 * p[0] * p[4]
                            + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.00494384765625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.017578125
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 2.0
                        * (0.5 * p[0] * p[4]
                            + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.015625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.0416666666666667
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 4.0
                        * (0.625 * p[0] * p[4]
                            + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.03814697265625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.0813802083333333
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 2.0
                        * (0.75 * p[0] * p[4]
                            + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.0791015625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.140625
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 4.0
                        * (0.875 * p[0] * p[4]
                            + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.14654541015625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.223307291666667
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + (p[0] * p[4]
                        + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.333333333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin())
                + y_0
                - y_f)
            * (0.2259521484375
                * p[4]
                * (0.125 * p[0] * p[4]
                    + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 6.103515625e-5
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.000651041666666667
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos()
                + 0.3544921875
                    * p[4]
                    * (0.25 * p[0] * p[4]
                        + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0009765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.00520833333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 1.2161865234375
                    * p[4]
                    * (0.375 * p[0] * p[4]
                        + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.00494384765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.017578125
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 0.796875
                    * p[4]
                    * (0.5 * p[0] * p[4]
                        + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0416666666666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 1.7669677734375
                    * p[4]
                    * (0.625 * p[0] * p[4]
                        + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.03814697265625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0813802083333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 0.8701171875
                    * p[4]
                    * (0.75 * p[0] * p[4]
                        + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0791015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.140625 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 1.5970458984375
                    * p[4]
                    * (0.875 * p[0] * p[4]
                        + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.14654541015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.223307291666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 0.375
                    * p[4]
                    * (p[0] * p[4]
                        + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.333333333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos())
        + 0.75
            * gamma
            * p[4]
            * (p[0] * p[4]
                + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                + 0.333333333333333 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                + psi_0
                - psi_f)
        + 9.0 * p[0] * p[4]
        + 0.2 * p[4] * (-634.5 * p[0] + 1498.5 * p[1] - 1174.5 * p[2] + 310.5 * p[3])
        + 0.333333333333333 * p[4] * (-144.0 * p[0] + 162.0 * p[1] - 81.0 * p[2] + 18.0 * p[3])
        + 0.142857142857143 * p[4] * (-121.5 * p[0] + 364.5 * p[1] - 364.5 * p[2] + 121.5 * p[3])
        + 0.25 * p[4] * (436.5 * p[0] - 810.0 * p[1] + 526.5 * p[2] - 126.0 * p[3])
        + 0.166666666666667 * p[4] * (445.5 * p[0] - 1215.0 * p[1] + 1093.5 * p[2] - 324.0 * p[3]);

    let dc_dp_2 = (1_f64 / 12.0)
        * alpha
        * p[4]
        * ((1_f64 / 24.0)
            * p[4]
            * (psi_0.cos()
                + 4.0
                    * (0.125 * p[0] * p[4]
                        + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 6.103515625e-5
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.000651041666666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 2.0
                    * (0.25 * p[0] * p[4]
                        + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0009765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.00520833333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 4.0
                    * (0.375 * p[0] * p[4]
                        + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.00494384765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.017578125
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 2.0
                    * (0.5 * p[0] * p[4]
                        + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0416666666666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 4.0
                    * (0.625 * p[0] * p[4]
                        + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.03814697265625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0813802083333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 2.0
                    * (0.75 * p[0] * p[4]
                        + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0791015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.140625
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 4.0
                    * (0.875 * p[0] * p[4]
                        + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.14654541015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.223307291666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + (p[0] * p[4]
                    + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.333333333333333
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos())
            + x_0
            - x_f)
        * (0.0970458984375
            * p[4]
            * (0.125 * p[0] * p[4]
                + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                + 6.103515625e-5 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                + 0.000651041666666667
                    * p[4]
                    * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                + psi_0)
                .sin()
            + 0.1201171875
                * p[4]
                * (0.25 * p[0] * p[4]
                    + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.0009765625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.00520833333333333
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
            + 0.2669677734375
                * p[4]
                * (0.375 * p[0] * p[4]
                    + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.00494384765625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.017578125 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
            + 0.046875
                * p[4]
                * (0.5 * p[0] * p[4]
                    + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.015625 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.0416666666666667
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
            - 0.2838134765625
                * p[4]
                * (0.625 * p[0] * p[4]
                    + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.03814697265625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.0813802083333333
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
            - 0.3955078125
                * p[4]
                * (0.75 * p[0] * p[4]
                    + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.0791015625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.140625 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
            - 1.2740478515625
                * p[4]
                * (0.875 * p[0] * p[4]
                    + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.14654541015625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.223307291666667
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
            - 0.375
                * p[4]
                * (p[0] * p[4]
                    + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.333333333333333
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin())
        + (1_f64 / 12.0)
            * beta
            * p[4]
            * ((1_f64 / 24.0)
                * p[4]
                * (psi_0.sin()
                    + 4.0
                        * (0.125 * p[0] * p[4]
                            + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 6.103515625e-5
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.000651041666666667
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 2.0
                        * (0.25 * p[0] * p[4]
                            + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.0009765625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.00520833333333333
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 4.0
                        * (0.375 * p[0] * p[4]
                            + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.00494384765625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.017578125
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 2.0
                        * (0.5 * p[0] * p[4]
                            + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.015625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.0416666666666667
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 4.0
                        * (0.625 * p[0] * p[4]
                            + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.03814697265625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.0813802083333333
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 2.0
                        * (0.75 * p[0] * p[4]
                            + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.0791015625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.140625
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 4.0
                        * (0.875 * p[0] * p[4]
                            + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.14654541015625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.223307291666667
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + (p[0] * p[4]
                        + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.333333333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin())
                + y_0
                - y_f)
            * (-0.0970458984375
                * p[4]
                * (0.125 * p[0] * p[4]
                    + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 6.103515625e-5
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.000651041666666667
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos()
                - 0.1201171875
                    * p[4]
                    * (0.25 * p[0] * p[4]
                        + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0009765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.00520833333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                - 0.2669677734375
                    * p[4]
                    * (0.375 * p[0] * p[4]
                        + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.00494384765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.017578125
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                - 0.046875
                    * p[4]
                    * (0.5 * p[0] * p[4]
                        + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0416666666666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 0.2838134765625
                    * p[4]
                    * (0.625 * p[0] * p[4]
                        + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.03814697265625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0813802083333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 0.3955078125
                    * p[4]
                    * (0.75 * p[0] * p[4]
                        + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0791015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.140625 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 1.2740478515625
                    * p[4]
                    * (0.875 * p[0] * p[4]
                        + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.14654541015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.223307291666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 0.375
                    * p[4]
                    * (p[0] * p[4]
                        + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.333333333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos())
        + 0.75
            * gamma
            * p[4]
            * (p[0] * p[4]
                + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                + 0.333333333333333 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                + psi_0
                - psi_f)
        - 4.5 * p[0] * p[4]
        + 0.166666666666667 * p[4] * (-405.0 * p[0] + 1093.5 * p[1] - 972.0 * p[2] + 283.5 * p[3])
        + 0.25 * p[4] * (-306.0 * p[0] + 526.5 * p[1] - 324.0 * p[2] + 76.5 * p[3])
        + 0.333333333333333 * p[4] * (85.5 * p[0] - 81.0 * p[1] + 40.5 * p[2] - 9.0 * p[3])
        + 0.142857142857143 * p[4] * (121.5 * p[0] - 364.5 * p[1] + 364.5 * p[2] - 121.5 * p[3])
        + 0.2 * p[4] * (513.0 * p[0] - 1174.5 * p[1] + 891.0 * p[2] - 229.5 * p[3]);

    let dc_dp_4 = alpha
        * ((1_f64 / 24.0)
            * p[4]
            * (psi_0.cos()
                + 4.0
                    * (0.125 * p[0] * p[4]
                        + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 6.103515625e-5
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.000651041666666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 2.0
                    * (0.25 * p[0] * p[4]
                        + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0009765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.00520833333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 4.0
                    * (0.375 * p[0] * p[4]
                        + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.00494384765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.017578125
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 2.0
                    * (0.5 * p[0] * p[4]
                        + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0416666666666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 4.0
                    * (0.625 * p[0] * p[4]
                        + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.03814697265625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0813802083333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 2.0
                    * (0.75 * p[0] * p[4]
                        + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0791015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.140625
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + 4.0
                    * (0.875 * p[0] * p[4]
                        + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.14654541015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.223307291666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                + (p[0] * p[4]
                    + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.333333333333333
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos())
            + x_0
            - x_f)
        * ((1_f64 / 12.0)
            * p[4]
            * (-4.0
                * (0.087615966796875 * p[0] + 0.056488037109375 * p[1]
                    - 0.024261474609375 * p[2]
                    + 0.005157470703125 * p[3])
                * (0.125 * p[0] * p[4]
                    + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 6.103515625e-5
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.000651041666666667
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .sin()
                - 4.0
                    * (0.111541748046875 * p[0]
                        + 0.441741943359375 * p[1]
                        + 0.070953369140625 * p[2]
                        + 0.000762939453125 * p[3])
                    * (0.625 * p[0] * p[4]
                        + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.03814697265625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0813802083333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                - 2.0
                    * (0.11279296875 * p[0]
                        + 0.43505859375 * p[1]
                        + 0.19775390625 * p[2]
                        + 0.00439453125 * p[3])
                    * (0.75 * p[0] * p[4]
                        + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0791015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.140625
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                - 2.0
                    * (0.1171875 * p[0] + 0.3984375 * p[1] - 0.0234375 * p[2] + 0.0078125 * p[3])
                    * (0.5 * p[0] * p[4]
                        + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0416666666666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                - 4.0
                    * (0.119842529296875 * p[0]
                        + 0.399261474609375 * p[1]
                        + 0.318511962890625 * p[2]
                        + 0.037384033203125 * p[3])
                    * (0.875 * p[0] * p[4]
                        + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.14654541015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.223307291666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                - 2.0
                    * (0.12060546875 * p[0] + 0.17724609375 * p[1] - 0.06005859375 * p[2]
                        + 0.01220703125 * p[3])
                    * (0.25 * p[0] * p[4]
                        + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0009765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.00520833333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                - 4.0
                    * (0.124237060546875 * p[0] + 0.304046630859375 * p[1]
                        - 0.066741943359375 * p[2]
                        + 0.013458251953125 * p[3])
                    * (0.375 * p[0] * p[4]
                        + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.00494384765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.017578125
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                - (0.125 * p[0] + 0.375 * p[1] + 0.375 * p[2] + 0.125 * p[3])
                    * (p[0] * p[4]
                        + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.333333333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin())
            + (1_f64 / 12.0) * psi_0.cos()
            + (1_f64 / 3.0)
                * (0.125 * p[0] * p[4]
                    + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 6.103515625e-5
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.000651041666666667
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos()
            + (1_f64 / 6.0)
                * (0.25 * p[0] * p[4]
                    + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.0009765625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.00520833333333333
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos()
            + (1_f64 / 3.0)
                * (0.375 * p[0] * p[4]
                    + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.00494384765625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.017578125 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos()
            + (1_f64 / 6.0)
                * (0.5 * p[0] * p[4]
                    + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.015625 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.0416666666666667
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos()
            + (1_f64 / 3.0)
                * (0.625 * p[0] * p[4]
                    + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.03814697265625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.0813802083333333
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos()
            + (1_f64 / 6.0)
                * (0.75 * p[0] * p[4]
                    + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.0791015625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.140625 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos()
            + (1_f64 / 3.0)
                * (0.875 * p[0] * p[4]
                    + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.14654541015625
                        * p[4]
                        * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.223307291666667
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos()
            + (1_f64 / 12.0)
                * (p[0] * p[4]
                    + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                    + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                    + 0.333333333333333
                        * p[4]
                        * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                    + psi_0)
                    .cos())
        + beta
            * ((1_f64 / 24.0)
                * p[4]
                * (psi_0.sin()
                    + 4.0
                        * (0.125 * p[0] * p[4]
                            + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 6.103515625e-5
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.000651041666666667
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 2.0
                        * (0.25 * p[0] * p[4]
                            + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.0009765625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.00520833333333333
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 4.0
                        * (0.375 * p[0] * p[4]
                            + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.00494384765625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.017578125
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 2.0
                        * (0.5 * p[0] * p[4]
                            + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.015625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.0416666666666667
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 4.0
                        * (0.625 * p[0] * p[4]
                            + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.03814697265625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.0813802083333333
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 2.0
                        * (0.75 * p[0] * p[4]
                            + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.0791015625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.140625
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + 4.0
                        * (0.875 * p[0] * p[4]
                            + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.14654541015625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.223307291666667
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .sin()
                    + (p[0] * p[4]
                        + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.333333333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin())
                + y_0
                - y_f)
            * ((1_f64 / 12.0)
                * p[4]
                * (4.0
                    * (0.087615966796875 * p[0] + 0.056488037109375 * p[1]
                        - 0.024261474609375 * p[2]
                        + 0.005157470703125 * p[3])
                    * (0.125 * p[0] * p[4]
                        + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 6.103515625e-5
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.000651041666666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .cos()
                    + 4.0
                        * (0.111541748046875 * p[0]
                            + 0.441741943359375 * p[1]
                            + 0.070953369140625 * p[2]
                            + 0.000762939453125 * p[3])
                        * (0.625 * p[0] * p[4]
                            + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.03814697265625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.0813802083333333
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .cos()
                    + 2.0
                        * (0.11279296875 * p[0]
                            + 0.43505859375 * p[1]
                            + 0.19775390625 * p[2]
                            + 0.00439453125 * p[3])
                        * (0.75 * p[0] * p[4]
                            + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.0791015625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.140625
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .cos()
                    + 2.0
                        * (0.1171875 * p[0] + 0.3984375 * p[1] - 0.0234375 * p[2]
                            + 0.0078125 * p[3])
                        * (0.5 * p[0] * p[4]
                            + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.015625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.0416666666666667
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .cos()
                    + 4.0
                        * (0.119842529296875 * p[0]
                            + 0.399261474609375 * p[1]
                            + 0.318511962890625 * p[2]
                            + 0.037384033203125 * p[3])
                        * (0.875 * p[0] * p[4]
                            + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.14654541015625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.223307291666667
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .cos()
                    + 2.0
                        * (0.12060546875 * p[0] + 0.17724609375 * p[1] - 0.06005859375 * p[2]
                            + 0.01220703125 * p[3])
                        * (0.25 * p[0] * p[4]
                            + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.0009765625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.00520833333333333
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .cos()
                    + 4.0
                        * (0.124237060546875 * p[0] + 0.304046630859375 * p[1]
                            - 0.066741943359375 * p[2]
                            + 0.013458251953125 * p[3])
                        * (0.375 * p[0] * p[4]
                            + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.00494384765625
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.017578125
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .cos()
                    + (0.125 * p[0] + 0.375 * p[1] + 0.375 * p[2] + 0.125 * p[3])
                        * (p[0] * p[4]
                            + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                            + 0.25
                                * p[4]
                                * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                            + 0.333333333333333
                                * p[4]
                                * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                            + psi_0)
                            .cos())
                + (1_f64 / 12.0) * psi_0.sin()
                + (1_f64 / 3.0)
                    * (0.125 * p[0] * p[4]
                        + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 6.103515625e-5
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.000651041666666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                + (1_f64 / 6.0)
                    * (0.25 * p[0] * p[4]
                        + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0009765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.00520833333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                + (1_f64 / 3.0)
                    * (0.375 * p[0] * p[4]
                        + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.00494384765625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.017578125
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                + (1_f64 / 6.0)
                    * (0.5 * p[0] * p[4]
                        + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0416666666666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                + (1_f64 / 3.0)
                    * (0.625 * p[0] * p[4]
                        + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.03814697265625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.0813802083333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                + (1_f64 / 6.0)
                    * (0.75 * p[0] * p[4]
                        + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.0791015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.140625 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                + (1_f64 / 3.0)
                    * (0.875 * p[0] * p[4]
                        + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.14654541015625
                            * p[4]
                            * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.223307291666667
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin()
                + (1_f64 / 12.0)
                    * (p[0] * p[4]
                        + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                        + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                        + 0.333333333333333
                            * p[4]
                            * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                        + psi_0)
                        .sin())
        + gamma
            * (0.25 * p[0] + 0.75 * p[1] + 0.75 * p[2] + 0.25 * p[3])
            * (p[0] * p[4]
                + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
                + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
                + 0.333333333333333 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
                + psi_0
                - psi_f)
        + 0.0761904761904759 * p[0].powi(2)
        + 0.117857142857133 * p[0] * p[1]
        - 0.0428571428571303 * p[0] * p[2]
        + 0.0226190476190471 * p[0] * p[3]
        + 0.385714285714272 * p[1].powi(2)
        - 0.0964285714285893 * p[1] * p[2]
        - 0.0428571428571445 * p[1] * p[3]
        + 0.3857142857143 * p[2].powi(2)
        + 0.117857142857133 * p[2] * p[3]
        + 0.0761904761904771 * p[3].powi(2);

    [dc_dp_1, dc_dp_2, dc_dp_4]
}

pub fn bending_energy(p: &SpiralParameters) -> f64 {
    p[0].powi(2) * p[4]
        + 0.5
            * p[4]
            * (-11.0 * p[0].powi(2) + 18.0 * p[0] * p[1] - 9.0 * p[0] * p[2] + 2.0 * p[0] * p[3])
        + 0.25
            * p[4]
            * (-108.0 * p[0].powi(2) + 436.5 * p[0] * p[1] - 306.0 * p[0] * p[2]
                + 76.5 * p[0] * p[3]
                - 405.0 * p[1].powi(2)
                + 526.5 * p[1] * p[2]
                - 126.0 * p[1] * p[3]
                - 162.0 * p[2].powi(2)
                + 76.5 * p[2] * p[3]
                - 9.0 * p[3].powi(2))
        + 0.166666666666667
            * p[4]
            * (-81.0 * p[0].powi(2) + 445.5 * p[0] * p[1] - 405.0 * p[0] * p[2]
                + 121.5 * p[0] * p[3]
                - 607.5 * p[1].powi(2)
                + 1093.5 * p[1] * p[2]
                - 324.0 * p[1] * p[3]
                - 486.0 * p[2].powi(2)
                + 283.5 * p[2] * p[3]
                - 40.5 * p[3].powi(2))
        + 0.142857142857143
            * p[4]
            * (20.25 * p[0].powi(2) - 121.5 * p[0] * p[1] + 121.5 * p[0] * p[2]
                - 40.5 * p[0] * p[3]
                + 182.25 * p[1].powi(2)
                - 364.5 * p[1] * p[2]
                + 121.5 * p[1] * p[3]
                + 182.25 * p[2].powi(2)
                - 121.5 * p[2] * p[3]
                + 20.25 * p[3].powi(2))
        + 0.333333333333333
            * p[4]
            * (48.25 * p[0].powi(2) - 144.0 * p[0] * p[1] + 85.5 * p[0] * p[2] - 20.0 * p[0] * p[3]
                + 81.0 * p[1].powi(2)
                - 81.0 * p[1] * p[2]
                + 18.0 * p[1] * p[3]
                + 20.25 * p[2].powi(2)
                - 9.0 * p[2] * p[3]
                + p[3].powi(2))
        + 0.2
            * p[4]
            * (130.5 * p[0].powi(2) - 634.5 * p[0] * p[1] + 513.0 * p[0] * p[2]
                - 139.5 * p[0] * p[3]
                + 749.25 * p[1].powi(2)
                - 1174.5 * p[1] * p[2]
                + 310.5 * p[1] * p[3]
                + 445.5 * p[2].powi(2)
                - 229.5 * p[2] * p[3]
                + 29.25 * p[3].powi(2))
}

pub fn soft_constraints(
    p: &SpiralParameters,
    alpha: f64,
    beta: f64,
    gamma: f64,
    x_0: f64,
    y_0: f64,
    psi_0: f64,
    x_f: f64,
    y_f: f64,
    psi_f: f64,
) -> f64 {
    let tmp_0 = p[0] * p[4];

    let (tmp_1_sin, tmp_1_cos) = (0.125 * tmp_0
        + 0.0078125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
        + 6.103515625e-5 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
        + 0.000651041666666667 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
        + psi_0)
        .sin_cos();
    let (tmp_2_sin, tmp_2_cos) = (0.25 * tmp_0
        + 0.03125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
        + 0.0009765625 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
        + 0.00520833333333333 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
        + psi_0)
        .sin_cos();
    let (tmp_3_sin, tmp_3_cos) = (0.375 * tmp_0
        + 0.0703125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
        + 0.00494384765625 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
        + 0.017578125 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
        + psi_0)
        .sin_cos();
    let (tmp_4_sin, tmp_4_cos) = (0.5 * tmp_0
        + 0.125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
        + 0.015625 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
        + 0.0416666666666667 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
        + psi_0)
        .sin_cos();
    let (tmp_5_sin, tmp_5_cos) = (0.625 * tmp_0
        + 0.1953125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
        + 0.03814697265625 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
        + 0.0813802083333333 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
        + psi_0)
        .sin_cos();
    let (tmp_6_sin, tmp_6_cos) = (0.75 * tmp_0
        + 0.28125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
        + 0.0791015625 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
        + 0.140625 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
        + psi_0)
        .sin_cos();
    let (tmp_7_sin, tmp_7_cos) = (0.875 * tmp_0
        + 0.3828125 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
        + 0.14654541015625 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
        + 0.223307291666667 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
        + psi_0)
        .sin_cos();
    let tmp_8 = tmp_0
        + 0.5 * p[4] * (-5.5 * p[0] + 9.0 * p[1] - 4.5 * p[2] + p[3])
        + 0.25 * p[4] * (-4.5 * p[0] + 13.5 * p[1] - 13.5 * p[2] + 4.5 * p[3])
        + 0.333333333333333 * p[4] * (9.0 * p[0] - 22.5 * p[1] + 18.0 * p[2] - 4.5 * p[3])
        + psi_0;
    let (tmp_8_sin, tmp_8_cos) = tmp_8.sin_cos();

    alpha
        * ((1_f64 / 24.0)
            * p[4]
            * (psi_0.cos()
                + 4.0 * tmp_1_cos
                + 2.0 * tmp_2_cos
                + 4.0 * tmp_3_cos
                + 2.0 * tmp_4_cos
                + 4.0 * tmp_5_cos
                + 2.0 * tmp_6_cos
                + 4.0 * tmp_7_cos
                + tmp_8_cos)
            + x_0
            - x_f)
            .powi(2)
        + beta
            * ((1_f64 / 24.0)
                * p[4]
                * (psi_0.sin()
                    + 4.0 * tmp_1_sin
                    + 2.0 * tmp_2_sin
                    + 4.0 * tmp_3_sin
                    + 2.0 * tmp_4_sin
                    + 4.0 * tmp_5_sin
                    + 2.0 * tmp_6_sin
                    + 4.0 * tmp_7_sin
                    + tmp_8_sin)
                + y_0
                - y_f)
                .powi(2)
        + gamma * (tmp_8 - psi_f).powi(2)
}
